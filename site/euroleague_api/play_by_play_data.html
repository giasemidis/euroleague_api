<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

  
  <title>euroleague_api.play_by_play_data API documentation</title>
  <meta name="description" content="" />


  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}
</style>
  <style type="text/css">
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/
</style>
  <style type="text/css">
  pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.codehilite .hll { background-color: #ffffcc }
.codehilite { background: #f8f8f8; }
.codehilite .c { color: #3D7B7B; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #9C6500 } /* Comment.Preproc */
.codehilite .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.codehilite .gr { color: #E40000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #008400 } /* Generic.Inserted */
.codehilite .go { color: #717171 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #687822 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #717171; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #767600 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #A45A77 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>
  <style type="text/css">
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}
</style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>
<div id="container">
  


















  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3>Super-module</h3>
      <ul>
        <li class="mono"><a href="index.html">euroleague_api</a></li>
      </ul>
    </li>
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#euroleague_api.play_by_play_data.logger">logger</a></li>
  </ul>

    </li>


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#euroleague_api.play_by_play_data.PlayByPlay">PlayByPlay</a></span>
        
          
  <ul>
    <li class="mono"><a href="#euroleague_api.play_by_play_data.PlayByPlay.get_game_gamecodes_season">get_game_gamecodes_season</a></li>
    <li class="mono"><a href="#euroleague_api.play_by_play_data.PlayByPlay.get_game_play_by_play_data">get_game_play_by_play_data</a></li>
    <li class="mono"><a href="#euroleague_api.play_by_play_data.PlayByPlay.get_game_play_by_play_data_multiple_seasons">get_game_play_by_play_data_multiple_seasons</a></li>
    <li class="mono"><a href="#euroleague_api.play_by_play_data.PlayByPlay.get_game_play_by_play_data_single_season">get_game_play_by_play_data_single_season</a></li>
    <li class="mono"><a href="#euroleague_api.play_by_play_data.PlayByPlay.get_pbp_data_with_lineups">get_pbp_data_with_lineups</a></li>
    <li class="mono"><a href="#euroleague_api.play_by_play_data.PlayByPlay.get_pbp_data_with_lineups_multiple_seasons">get_pbp_data_with_lineups_multiple_seasons</a></li>
    <li class="mono"><a href="#euroleague_api.play_by_play_data.PlayByPlay.get_pbp_data_with_lineups_single_season">get_pbp_data_with_lineups_single_season</a></li>
    <li class="mono"><a href="#euroleague_api.play_by_play_data.PlayByPlay.get_range_seasons_data">get_range_seasons_data</a></li>
    <li class="mono"><a href="#euroleague_api.play_by_play_data.PlayByPlay.get_season_data_from_game_data">get_season_data_from_game_data</a></li>
    <li class="mono"><a href="#euroleague_api.play_by_play_data.PlayByPlay.make_season_game_url">make_season_game_url</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

<article id="content">
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">euroleague_api.play_by_play_data</span> module</h1>
  
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-euroleague_api.play_by_play_data', this);">Show source &equiv;</a></p>
  <div id="source-euroleague_api.play_by_play_data" class="source">
    <div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">json.decoder</span> <span class="kn">import</span> <span class="n">JSONDecodeError</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">.EuroLeagueData</span> <span class="kn">import</span> <span class="n">EuroLeagueData</span>
<span class="kn">from</span> <span class="nn">.boxscore_data</span> <span class="kn">import</span> <span class="n">BoxScoreData</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">get_requests</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">PlayByPlay</span><span class="p">(</span><span class="n">EuroLeagueData</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for getting the game play-by-play data.</span>

<span class="sd">    Args:</span>
<span class="sd">        competition (str, optional): The competition code, inherited from the</span>
<span class="sd">            `EuroLeagueData` class. Choose one of:</span>
<span class="sd">            - &#39;E&#39; for Euroleague</span>
<span class="sd">            - &#39;U&#39; for Eurocup</span>
<span class="sd">            Defaults to &quot;E&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_game_play_by_play_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">gamecode</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function that gets the play-by-play data of a particular game.</span>

<span class="sd">        Args:</span>

<span class="sd">            season (int): The start year of the season</span>

<span class="sd">            gamecode (int): The game-code of the game of interest.</span>
<span class="sd">                It can be found on Euroleague&#39;s website.</span>

<span class="sd">        Returns:</span>

<span class="sd">            pd.DataFrame: A dataframe with the play-by-play data of the game.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://live.euroleague.net/api/PlaybyPlay&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;gamecode&quot;</span><span class="p">:</span> <span class="n">gamecode</span><span class="p">,</span>
            <span class="s2">&quot;seasoncode&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">competition</span><span class="si">}{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">get_requests</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Game code, </span><span class="si">{</span><span class="n">gamecode</span><span class="si">}</span><span class="s2">, did not return any data.&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>

        <span class="n">periods</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;FirstQuarter&#39;</span><span class="p">,</span> <span class="s1">&#39;SecondQuarter&#39;</span><span class="p">,</span> <span class="s1">&#39;ThirdQuarter&#39;</span><span class="p">,</span> <span class="s1">&#39;ForthQuarter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ExtraTime&#39;</span>
        <span class="p">]</span>
        <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">period</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">periods</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">period</span><span class="p">]:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">period</span><span class="p">])</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PERIOD&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="n">pbp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">all_data</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">pbp_df</span><span class="p">[</span><span class="s1">&#39;CODETEAM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_df</span><span class="p">[</span><span class="s1">&#39;CODETEAM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">pbp_df</span><span class="p">[</span><span class="s1">&#39;PLAYER_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_df</span><span class="p">[</span><span class="s1">&#39;PLAYER_ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">pbp_df</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_df</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">pbp_df</span><span class="p">[</span><span class="s2">&quot;MARKERTIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_df</span><span class="p">[</span><span class="s2">&quot;MARKERTIME&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">pbp_df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Season&#39;</span><span class="p">,</span> <span class="n">season</span><span class="p">)</span>
        <span class="n">pbp_df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Gamecode&#39;</span><span class="p">,</span> <span class="n">gamecode</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pbp_df</span>

    <span class="k">def</span> <span class="nf">get_game_play_by_play_data_single_season</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">season</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function that gets the play-by-play data of *all* games in a single</span>
<span class="sd">        season</span>

<span class="sd">        Args:</span>

<span class="sd">            season (int): The start year of the season</span>

<span class="sd">        Returns:</span>

<span class="sd">            pd.DataFrame: A dataframe with the play-by-play data of all games</span>
<span class="sd">                in a single season</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_season_data_from_game_data</span><span class="p">(</span>
            <span class="n">season</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_play_by_play_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data_df</span>

    <span class="k">def</span> <span class="nf">get_game_play_by_play_data_multiple_seasons</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">start_season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_season</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function that gets the play-by-play data of *all* games in a range of</span>
<span class="sd">        seasons</span>

<span class="sd">        Args:</span>

<span class="sd">            start_season (int): The start year of the start season</span>

<span class="sd">            end_season (int): The start year of the end season</span>

<span class="sd">        Returns:</span>

<span class="sd">            pd.DataFrame: A dataframe with the play-by-play data of all games</span>
<span class="sd">                in range of seasons</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_range_seasons_data</span><span class="p">(</span>
            <span class="n">start_season</span><span class="p">,</span> <span class="n">end_season</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_play_by_play_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">get_pbp_data_with_lineups</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">season</span><span class="p">,</span>
        <span class="n">gamecode</span><span class="p">,</span>
        <span class="n">validate</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the play-by-play (PBP) data enriched with the teams&#39; lineups for</span>
<span class="sd">        every action in the PBP data.</span>

<span class="sd">        There are three cases where the player in the corresponding row</span>
<span class="sd">        (action) is not part of the lineup:</span>

<span class="sd">            1. When the player is subbed &quot;OUT&quot;, the assigned lineup does not</span>
<span class="sd">            contain player name. Since this is reasonable, the value of the</span>
<span class="sd">            `validate_on_court_player` indicator is set to `True`.</span>

<span class="sd">            2. A player passes on to a teamate, who draws a shooting foul. If</span>
<span class="sd">            the passer is subbed before the first free throw and the first free</span>
<span class="sd">            throw is made then the subbed player is given an assist. However,</span>
<span class="sd">            the player is not in the extracted lineup because he has already</span>
<span class="sd">            been subbed. The value of the `validate_on_court_player`</span>
<span class="sd">            indicator is set to `False`. We don&#39;t fix the lineup, because it</span>
<span class="sd">            breaks the lineup continuinity. It is a quirk of the data</span>
<span class="sd">            collection andrecording.</span>

<span class="sd">            3. There are a few instances where a sub is recorded many seconds</span>
<span class="sd">            and actions since it actually happened. This causes issues, such</span>
<span class="sd">            as a player records an actions, such as a rebound, but he comes</span>
<span class="sd">            on the court (according to the data) many seconds after. This has</span>
<span class="sd">            been validated by watching theactual footage of the game. This</span>
<span class="sd">            requires a lot of manual work, which is beyond the score of this</span>
<span class="sd">            library. It is another quirk of the datacollection and recording,</span>
<span class="sd">            hence the value of the `validate_on_court_player` indicator is set</span>
<span class="sd">            to `False`.</span>

<span class="sd">        Args:</span>

<span class="sd">            season (int): The start year of the season</span>

<span class="sd">            gamecode (int): The game-code of the game of interest.</span>
<span class="sd">                It can be found on Euroleague&#39;s website.</span>

<span class="sd">            validate (bool, optional): A bool indicator whether to enrich the</span>
<span class="sd">                dataframe with two extra columns, which validate the validity</span>
<span class="sd">                and consistency of the extracted lineup. Defaults to True.</span>

<span class="sd">        Returns:</span>

<span class="sd">            pd.DataFrame: A dataframe with the play-by-play enriched with</span>
<span class="sd">                teams&#39; lineups</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">process_sub</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">):</span>
            <span class="n">opp_sub_type</span> <span class="o">=</span> <span class="s2">&quot;OUT&quot;</span> <span class="k">if</span> <span class="n">sub_type</span> <span class="o">==</span> <span class="s2">&quot;IN&quot;</span> <span class="k">else</span> <span class="s2">&quot;IN&quot;</span>
            <span class="n">potential_indx</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">pbp_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span>
                    <span class="p">(</span><span class="n">pbp_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:,</span> <span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">opp_sub_type</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">potential_nops</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="n">potential_indx</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">processed_idxs</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">matching_idx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">potential_nops</span><span class="p">)</span>
            <span class="n">processed_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="n">processed_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matching_idx</span><span class="p">)</span>
            <span class="n">matching_row</span> <span class="o">=</span> <span class="n">pbp_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">matching_idx</span><span class="p">]</span>
            <span class="n">invalid_mask</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">matching_row</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">opp_sub_type</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">matching_row</span><span class="p">[</span><span class="s2">&quot;CODETEAM&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">team</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">matching_row</span><span class="p">[</span><span class="s2">&quot;MARKERTIME&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">markertime</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">invalid_mask</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Something went wrong for gamecode </span><span class="si">{</span><span class="n">gamecode</span><span class="si">}</span><span class="s2"> at sub &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;index </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> with matching sub index </span><span class="si">{</span><span class="n">matching_idx</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="n">player_sub</span> <span class="o">=</span> <span class="n">matching_row</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; ,&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
            <span class="n">player_in</span> <span class="o">=</span> <span class="n">player</span> <span class="k">if</span> <span class="n">sub_type</span> <span class="o">==</span> <span class="s2">&quot;IN&quot;</span> <span class="k">else</span> <span class="n">player_sub</span>
            <span class="n">player_out</span> <span class="o">=</span> <span class="n">player_sub</span> <span class="k">if</span> <span class="n">sub_type</span> <span class="o">==</span> <span class="s2">&quot;IN&quot;</span> <span class="k">else</span> <span class="n">player</span>
            <span class="k">if</span> <span class="n">player_in</span> <span class="o">==</span> <span class="n">player_out</span><span class="p">:</span>
                <span class="c1"># there are instance where the same player is subbed in and out</span>
                <span class="k">return</span> <span class="n">five</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pindx</span> <span class="o">=</span> <span class="n">five</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">player_out</span><span class="p">)</span>
                <span class="n">five</span> <span class="o">=</span> <span class="n">five</span><span class="p">[:</span><span class="n">pindx</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">player_in</span><span class="p">]</span> <span class="o">+</span> <span class="n">five</span><span class="p">[</span><span class="n">pindx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>
                <span class="k">return</span> <span class="n">five</span>

        <span class="k">def</span> <span class="nf">validate_player</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">):</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;OUT&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; ,&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">col1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="n">col2</span><span class="p">]):</span>
                    <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="n">flag</span>

        <span class="c1"># Get the starting line-ups from boxscore data</span>
        <span class="n">boxscoredata</span> <span class="o">=</span> <span class="n">BoxScoreData</span><span class="p">(</span><span class="n">competition</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">competition</span><span class="p">)</span>
        <span class="n">game_bxscr_stats</span> <span class="o">=</span> <span class="n">boxscoredata</span><span class="o">.</span><span class="n">get_player_boxscore_stats_data</span><span class="p">(</span>
            <span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">,</span> <span class="n">gamecode</span><span class="o">=</span><span class="n">gamecode</span><span class="p">)</span>

        <span class="c1"># find home and away teams</span>
        <span class="n">hm_aw</span> <span class="o">=</span> <span class="n">game_bxscr_stats</span><span class="p">[[</span><span class="s2">&quot;Home&quot;</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
        <span class="n">home_team</span> <span class="o">=</span> <span class="n">hm_aw</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hm_aw</span><span class="p">[</span><span class="s2">&quot;Home&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">away_team</span> <span class="o">=</span> <span class="n">hm_aw</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hm_aw</span><span class="p">[</span><span class="s2">&quot;Home&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">starting_five</span> <span class="o">=</span> <span class="n">game_bxscr_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="n">game_bxscr_stats</span><span class="p">[</span><span class="s2">&quot;IsStarter&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Team&quot;</span><span class="p">,</span> <span class="s2">&quot;Player&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">starting_five</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">starting_five</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Team&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cumcount</span><span class="p">()</span>

        <span class="c1"># Pivot the DataFrame</span>
        <span class="n">starting_five</span> <span class="o">=</span> <span class="n">starting_five</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span>
            <span class="n">index</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Team&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Player&#39;</span><span class="p">)</span>

        <span class="c1"># Reset index if needed</span>
        <span class="n">starting_five</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">starting_five</span> <span class="o">=</span> <span class="n">starting_five</span><span class="p">[[</span><span class="n">home_team</span><span class="p">,</span> <span class="n">away_team</span><span class="p">]]</span>
        <span class="n">starting_five_dict</span> <span class="o">=</span> <span class="n">starting_five</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>

        <span class="c1"># Fetch play-by-play data</span>
        <span class="n">pbp_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_play_by_play_data</span><span class="p">(</span>
            <span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">,</span> <span class="n">gamecode</span><span class="o">=</span><span class="n">gamecode</span><span class="p">)</span>

        <span class="c1"># Asign the starting lineups to the first entry of the PBP data.</span>
        <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;Lineup_A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;Lineup_B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">pbp_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Lineup_A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">starting_five_dict</span><span class="p">[</span><span class="n">home_team</span><span class="p">]</span>
        <span class="n">pbp_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Lineup_B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">starting_five_dict</span><span class="p">[</span><span class="n">away_team</span><span class="p">]</span>
        <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;IsHomeTeam&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;CODETEAM&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">home_team</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;CODETEAM&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">away_team</span><span class="p">,</span>
                     <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="p">)</span>

        <span class="c1"># start processing the sub entries, row by row.</span>
        <span class="n">processed_idxs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_five_home</span> <span class="o">=</span> <span class="n">starting_five_dict</span><span class="p">[</span><span class="n">home_team</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">current_five_away</span> <span class="o">=</span> <span class="n">starting_five_dict</span><span class="p">[</span><span class="n">away_team</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">pbp_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">playtype</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span>
            <span class="c1"># there are rare instances of an extra space in player name</span>
            <span class="n">player</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; ,&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">team</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;CODETEAM&quot;</span><span class="p">]</span>
            <span class="n">markertime</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;MARKERTIME&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">team</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">is_home</span> <span class="o">=</span> <span class="n">home_team</span> <span class="o">==</span> <span class="n">team</span>
                <span class="n">five</span> <span class="o">=</span> <span class="n">current_five_home</span> <span class="k">if</span> <span class="n">is_home</span> <span class="k">else</span> <span class="n">current_five_away</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">playtype</span> <span class="o">==</span> <span class="s2">&quot;OUT&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">processed_idxs</span><span class="p">):</span>
                    <span class="n">five</span> <span class="o">=</span> <span class="n">process_sub</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">playtype</span><span class="p">)</span>
                <span class="k">elif</span> <span class="p">(</span><span class="n">playtype</span> <span class="o">==</span> <span class="s2">&quot;IN&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">processed_idxs</span><span class="p">):</span>
                    <span class="n">five</span> <span class="o">=</span> <span class="n">process_sub</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">playtype</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">is_home</span><span class="p">:</span>
                    <span class="n">current_five_home</span> <span class="o">=</span> <span class="n">five</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">current_five_away</span> <span class="o">=</span> <span class="n">five</span>

            <span class="n">pbp_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;Lineup_A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_five_home</span>
            <span class="n">pbp_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;Lineup_B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_five_away</span>

        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
            <span class="n">lu_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">pbp_data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">u</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Lineup_&quot;</span><span class="p">)]</span>
            <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;validate_on_court_player&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">validate_player</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lu_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lu_cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">pbp_data</span>

    <span class="k">def</span> <span class="nf">get_pbp_data_with_lineups_single_season</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">season</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function that gets the play-by-play data enriched with team lineups</span>
<span class="sd">        of *all* games in a single season</span>

<span class="sd">        Args:</span>

<span class="sd">            season (int): The start year of the season</span>

<span class="sd">        Returns:</span>

<span class="sd">            pd.DataFrame: A dataframe with the play-by-play data of all games</span>
<span class="sd">                in a single season</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_season_data_from_game_data</span><span class="p">(</span>
            <span class="n">season</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pbp_data_with_lineups</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data_df</span>

    <span class="k">def</span> <span class="nf">get_pbp_data_with_lineups_multiple_seasons</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">start_season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_season</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function that gets the play-by-play data enriched with team lineups</span>
<span class="sd">        of *all* games in a range of seasons</span>

<span class="sd">        Args:</span>

<span class="sd">            start_season (int): The start year of the start season</span>

<span class="sd">            end_season (int): The start year of the end season</span>

<span class="sd">        Returns:</span>

<span class="sd">            pd.DataFrame: A dataframe with the play-by-play data of all games</span>
<span class="sd">                in range of seasons</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_range_seasons_data</span><span class="p">(</span>
            <span class="n">start_season</span><span class="p">,</span> <span class="n">end_season</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pbp_data_with_lineups</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="euroleague_api.play_by_play_data.logger" class="name">var <span class="ident">logger</span></p>
      
  
  <div class="source_cont">
</div>

      </div>


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="euroleague_api.play_by_play_data.PlayByPlay" class="name">class <span class="ident">PlayByPlay</span></p>
      
  
    <div class="desc"><p>A class for getting the game play-by-play data.</p>
<p>Args:
    competition (str, optional): The competition code, inherited from the
        <code>EuroLeagueData</code> class. Choose one of:
        - 'E' for Euroleague
        - 'U' for Eurocup
        Defaults to "E".</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-euroleague_api.play_by_play_data.PlayByPlay', this);">Show source &equiv;</a></p>
  <div id="source-euroleague_api.play_by_play_data.PlayByPlay" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">PlayByPlay</span><span class="p">(</span><span class="n">EuroLeagueData</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for getting the game play-by-play data.</span>

<span class="sd">    Args:</span>
<span class="sd">        competition (str, optional): The competition code, inherited from the</span>
<span class="sd">            `EuroLeagueData` class. Choose one of:</span>
<span class="sd">            - &#39;E&#39; for Euroleague</span>
<span class="sd">            - &#39;U&#39; for Eurocup</span>
<span class="sd">            Defaults to &quot;E&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_game_play_by_play_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">gamecode</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function that gets the play-by-play data of a particular game.</span>

<span class="sd">        Args:</span>

<span class="sd">            season (int): The start year of the season</span>

<span class="sd">            gamecode (int): The game-code of the game of interest.</span>
<span class="sd">                It can be found on Euroleague&#39;s website.</span>

<span class="sd">        Returns:</span>

<span class="sd">            pd.DataFrame: A dataframe with the play-by-play data of the game.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://live.euroleague.net/api/PlaybyPlay&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;gamecode&quot;</span><span class="p">:</span> <span class="n">gamecode</span><span class="p">,</span>
            <span class="s2">&quot;seasoncode&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">competition</span><span class="si">}{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">get_requests</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Game code, </span><span class="si">{</span><span class="n">gamecode</span><span class="si">}</span><span class="s2">, did not return any data.&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>

        <span class="n">periods</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;FirstQuarter&#39;</span><span class="p">,</span> <span class="s1">&#39;SecondQuarter&#39;</span><span class="p">,</span> <span class="s1">&#39;ThirdQuarter&#39;</span><span class="p">,</span> <span class="s1">&#39;ForthQuarter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ExtraTime&#39;</span>
        <span class="p">]</span>
        <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">period</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">periods</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">period</span><span class="p">]:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">period</span><span class="p">])</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PERIOD&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="n">pbp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">all_data</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">pbp_df</span><span class="p">[</span><span class="s1">&#39;CODETEAM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_df</span><span class="p">[</span><span class="s1">&#39;CODETEAM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">pbp_df</span><span class="p">[</span><span class="s1">&#39;PLAYER_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_df</span><span class="p">[</span><span class="s1">&#39;PLAYER_ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">pbp_df</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_df</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">pbp_df</span><span class="p">[</span><span class="s2">&quot;MARKERTIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_df</span><span class="p">[</span><span class="s2">&quot;MARKERTIME&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">pbp_df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Season&#39;</span><span class="p">,</span> <span class="n">season</span><span class="p">)</span>
        <span class="n">pbp_df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Gamecode&#39;</span><span class="p">,</span> <span class="n">gamecode</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pbp_df</span>

    <span class="k">def</span> <span class="nf">get_game_play_by_play_data_single_season</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">season</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function that gets the play-by-play data of *all* games in a single</span>
<span class="sd">        season</span>

<span class="sd">        Args:</span>

<span class="sd">            season (int): The start year of the season</span>

<span class="sd">        Returns:</span>

<span class="sd">            pd.DataFrame: A dataframe with the play-by-play data of all games</span>
<span class="sd">                in a single season</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_season_data_from_game_data</span><span class="p">(</span>
            <span class="n">season</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_play_by_play_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data_df</span>

    <span class="k">def</span> <span class="nf">get_game_play_by_play_data_multiple_seasons</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">start_season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_season</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function that gets the play-by-play data of *all* games in a range of</span>
<span class="sd">        seasons</span>

<span class="sd">        Args:</span>

<span class="sd">            start_season (int): The start year of the start season</span>

<span class="sd">            end_season (int): The start year of the end season</span>

<span class="sd">        Returns:</span>

<span class="sd">            pd.DataFrame: A dataframe with the play-by-play data of all games</span>
<span class="sd">                in range of seasons</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_range_seasons_data</span><span class="p">(</span>
            <span class="n">start_season</span><span class="p">,</span> <span class="n">end_season</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_play_by_play_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">get_pbp_data_with_lineups</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">season</span><span class="p">,</span>
        <span class="n">gamecode</span><span class="p">,</span>
        <span class="n">validate</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the play-by-play (PBP) data enriched with the teams&#39; lineups for</span>
<span class="sd">        every action in the PBP data.</span>

<span class="sd">        There are three cases where the player in the corresponding row</span>
<span class="sd">        (action) is not part of the lineup:</span>

<span class="sd">            1. When the player is subbed &quot;OUT&quot;, the assigned lineup does not</span>
<span class="sd">            contain player name. Since this is reasonable, the value of the</span>
<span class="sd">            `validate_on_court_player` indicator is set to `True`.</span>

<span class="sd">            2. A player passes on to a teamate, who draws a shooting foul. If</span>
<span class="sd">            the passer is subbed before the first free throw and the first free</span>
<span class="sd">            throw is made then the subbed player is given an assist. However,</span>
<span class="sd">            the player is not in the extracted lineup because he has already</span>
<span class="sd">            been subbed. The value of the `validate_on_court_player`</span>
<span class="sd">            indicator is set to `False`. We don&#39;t fix the lineup, because it</span>
<span class="sd">            breaks the lineup continuinity. It is a quirk of the data</span>
<span class="sd">            collection andrecording.</span>

<span class="sd">            3. There are a few instances where a sub is recorded many seconds</span>
<span class="sd">            and actions since it actually happened. This causes issues, such</span>
<span class="sd">            as a player records an actions, such as a rebound, but he comes</span>
<span class="sd">            on the court (according to the data) many seconds after. This has</span>
<span class="sd">            been validated by watching theactual footage of the game. This</span>
<span class="sd">            requires a lot of manual work, which is beyond the score of this</span>
<span class="sd">            library. It is another quirk of the datacollection and recording,</span>
<span class="sd">            hence the value of the `validate_on_court_player` indicator is set</span>
<span class="sd">            to `False`.</span>

<span class="sd">        Args:</span>

<span class="sd">            season (int): The start year of the season</span>

<span class="sd">            gamecode (int): The game-code of the game of interest.</span>
<span class="sd">                It can be found on Euroleague&#39;s website.</span>

<span class="sd">            validate (bool, optional): A bool indicator whether to enrich the</span>
<span class="sd">                dataframe with two extra columns, which validate the validity</span>
<span class="sd">                and consistency of the extracted lineup. Defaults to True.</span>

<span class="sd">        Returns:</span>

<span class="sd">            pd.DataFrame: A dataframe with the play-by-play enriched with</span>
<span class="sd">                teams&#39; lineups</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">process_sub</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">):</span>
            <span class="n">opp_sub_type</span> <span class="o">=</span> <span class="s2">&quot;OUT&quot;</span> <span class="k">if</span> <span class="n">sub_type</span> <span class="o">==</span> <span class="s2">&quot;IN&quot;</span> <span class="k">else</span> <span class="s2">&quot;IN&quot;</span>
            <span class="n">potential_indx</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">pbp_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span>
                    <span class="p">(</span><span class="n">pbp_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:,</span> <span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">opp_sub_type</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">potential_nops</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="n">potential_indx</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">processed_idxs</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">matching_idx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">potential_nops</span><span class="p">)</span>
            <span class="n">processed_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="n">processed_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matching_idx</span><span class="p">)</span>
            <span class="n">matching_row</span> <span class="o">=</span> <span class="n">pbp_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">matching_idx</span><span class="p">]</span>
            <span class="n">invalid_mask</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">matching_row</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">opp_sub_type</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">matching_row</span><span class="p">[</span><span class="s2">&quot;CODETEAM&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">team</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">matching_row</span><span class="p">[</span><span class="s2">&quot;MARKERTIME&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">markertime</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">invalid_mask</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Something went wrong for gamecode </span><span class="si">{</span><span class="n">gamecode</span><span class="si">}</span><span class="s2"> at sub &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;index </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> with matching sub index </span><span class="si">{</span><span class="n">matching_idx</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="n">player_sub</span> <span class="o">=</span> <span class="n">matching_row</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; ,&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
            <span class="n">player_in</span> <span class="o">=</span> <span class="n">player</span> <span class="k">if</span> <span class="n">sub_type</span> <span class="o">==</span> <span class="s2">&quot;IN&quot;</span> <span class="k">else</span> <span class="n">player_sub</span>
            <span class="n">player_out</span> <span class="o">=</span> <span class="n">player_sub</span> <span class="k">if</span> <span class="n">sub_type</span> <span class="o">==</span> <span class="s2">&quot;IN&quot;</span> <span class="k">else</span> <span class="n">player</span>
            <span class="k">if</span> <span class="n">player_in</span> <span class="o">==</span> <span class="n">player_out</span><span class="p">:</span>
                <span class="c1"># there are instance where the same player is subbed in and out</span>
                <span class="k">return</span> <span class="n">five</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pindx</span> <span class="o">=</span> <span class="n">five</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">player_out</span><span class="p">)</span>
                <span class="n">five</span> <span class="o">=</span> <span class="n">five</span><span class="p">[:</span><span class="n">pindx</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">player_in</span><span class="p">]</span> <span class="o">+</span> <span class="n">five</span><span class="p">[</span><span class="n">pindx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>
                <span class="k">return</span> <span class="n">five</span>

        <span class="k">def</span> <span class="nf">validate_player</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">):</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;OUT&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; ,&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">col1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="n">col2</span><span class="p">]):</span>
                    <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="n">flag</span>

        <span class="c1"># Get the starting line-ups from boxscore data</span>
        <span class="n">boxscoredata</span> <span class="o">=</span> <span class="n">BoxScoreData</span><span class="p">(</span><span class="n">competition</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">competition</span><span class="p">)</span>
        <span class="n">game_bxscr_stats</span> <span class="o">=</span> <span class="n">boxscoredata</span><span class="o">.</span><span class="n">get_player_boxscore_stats_data</span><span class="p">(</span>
            <span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">,</span> <span class="n">gamecode</span><span class="o">=</span><span class="n">gamecode</span><span class="p">)</span>

        <span class="c1"># find home and away teams</span>
        <span class="n">hm_aw</span> <span class="o">=</span> <span class="n">game_bxscr_stats</span><span class="p">[[</span><span class="s2">&quot;Home&quot;</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
        <span class="n">home_team</span> <span class="o">=</span> <span class="n">hm_aw</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hm_aw</span><span class="p">[</span><span class="s2">&quot;Home&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">away_team</span> <span class="o">=</span> <span class="n">hm_aw</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hm_aw</span><span class="p">[</span><span class="s2">&quot;Home&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">starting_five</span> <span class="o">=</span> <span class="n">game_bxscr_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="n">game_bxscr_stats</span><span class="p">[</span><span class="s2">&quot;IsStarter&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Team&quot;</span><span class="p">,</span> <span class="s2">&quot;Player&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">starting_five</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">starting_five</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Team&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cumcount</span><span class="p">()</span>

        <span class="c1"># Pivot the DataFrame</span>
        <span class="n">starting_five</span> <span class="o">=</span> <span class="n">starting_five</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span>
            <span class="n">index</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Team&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Player&#39;</span><span class="p">)</span>

        <span class="c1"># Reset index if needed</span>
        <span class="n">starting_five</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">starting_five</span> <span class="o">=</span> <span class="n">starting_five</span><span class="p">[[</span><span class="n">home_team</span><span class="p">,</span> <span class="n">away_team</span><span class="p">]]</span>
        <span class="n">starting_five_dict</span> <span class="o">=</span> <span class="n">starting_five</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>

        <span class="c1"># Fetch play-by-play data</span>
        <span class="n">pbp_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_play_by_play_data</span><span class="p">(</span>
            <span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">,</span> <span class="n">gamecode</span><span class="o">=</span><span class="n">gamecode</span><span class="p">)</span>

        <span class="c1"># Asign the starting lineups to the first entry of the PBP data.</span>
        <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;Lineup_A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;Lineup_B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">pbp_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Lineup_A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">starting_five_dict</span><span class="p">[</span><span class="n">home_team</span><span class="p">]</span>
        <span class="n">pbp_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Lineup_B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">starting_five_dict</span><span class="p">[</span><span class="n">away_team</span><span class="p">]</span>
        <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;IsHomeTeam&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;CODETEAM&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">home_team</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;CODETEAM&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">away_team</span><span class="p">,</span>
                     <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="p">)</span>

        <span class="c1"># start processing the sub entries, row by row.</span>
        <span class="n">processed_idxs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_five_home</span> <span class="o">=</span> <span class="n">starting_five_dict</span><span class="p">[</span><span class="n">home_team</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">current_five_away</span> <span class="o">=</span> <span class="n">starting_five_dict</span><span class="p">[</span><span class="n">away_team</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">pbp_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">playtype</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span>
            <span class="c1"># there are rare instances of an extra space in player name</span>
            <span class="n">player</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; ,&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">team</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;CODETEAM&quot;</span><span class="p">]</span>
            <span class="n">markertime</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;MARKERTIME&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">team</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">is_home</span> <span class="o">=</span> <span class="n">home_team</span> <span class="o">==</span> <span class="n">team</span>
                <span class="n">five</span> <span class="o">=</span> <span class="n">current_five_home</span> <span class="k">if</span> <span class="n">is_home</span> <span class="k">else</span> <span class="n">current_five_away</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">playtype</span> <span class="o">==</span> <span class="s2">&quot;OUT&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">processed_idxs</span><span class="p">):</span>
                    <span class="n">five</span> <span class="o">=</span> <span class="n">process_sub</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">playtype</span><span class="p">)</span>
                <span class="k">elif</span> <span class="p">(</span><span class="n">playtype</span> <span class="o">==</span> <span class="s2">&quot;IN&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">processed_idxs</span><span class="p">):</span>
                    <span class="n">five</span> <span class="o">=</span> <span class="n">process_sub</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">playtype</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">is_home</span><span class="p">:</span>
                    <span class="n">current_five_home</span> <span class="o">=</span> <span class="n">five</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">current_five_away</span> <span class="o">=</span> <span class="n">five</span>

            <span class="n">pbp_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;Lineup_A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_five_home</span>
            <span class="n">pbp_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;Lineup_B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_five_away</span>

        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
            <span class="n">lu_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">pbp_data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">u</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Lineup_&quot;</span><span class="p">)]</span>
            <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;validate_on_court_player&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">validate_player</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lu_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lu_cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">pbp_data</span>

    <span class="k">def</span> <span class="nf">get_pbp_data_with_lineups_single_season</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">season</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function that gets the play-by-play data enriched with team lineups</span>
<span class="sd">        of *all* games in a single season</span>

<span class="sd">        Args:</span>

<span class="sd">            season (int): The start year of the season</span>

<span class="sd">        Returns:</span>

<span class="sd">            pd.DataFrame: A dataframe with the play-by-play data of all games</span>
<span class="sd">                in a single season</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_season_data_from_game_data</span><span class="p">(</span>
            <span class="n">season</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pbp_data_with_lineups</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data_df</span>

    <span class="k">def</span> <span class="nf">get_pbp_data_with_lineups_multiple_seasons</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">start_season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_season</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function that gets the play-by-play data enriched with team lineups</span>
<span class="sd">        of *all* games in a range of seasons</span>

<span class="sd">        Args:</span>

<span class="sd">            start_season (int): The start year of the start season</span>

<span class="sd">            end_season (int): The start year of the end season</span>

<span class="sd">        Returns:</span>

<span class="sd">            pd.DataFrame: A dataframe with the play-by-play data of all games</span>
<span class="sd">                in range of seasons</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_range_seasons_data</span><span class="p">(</span>
            <span class="n">start_season</span><span class="p">,</span> <span class="n">end_season</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pbp_data_with_lineups</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="..\EuroLeagueData.html#euroleague_api.EuroLeagueData.EuroLeagueData">euroleague_api.EuroLeagueData.EuroLeagueData</a></li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="euroleague_api.play_by_play_data.PlayByPlay.BASE_URL" class="name">var <span class="ident">BASE_URL</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="euroleague_api.play_by_play_data.PlayByPlay.VERSION" class="name">var <span class="ident">VERSION</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="euroleague_api.play_by_play_data.PlayByPlay.get_game_gamecodes_season">
    <p>def <span class="ident">get_game_gamecodes_season</span>(</p><p>self, season: int)</p>
    </div>
    

    
  
    <div class="desc"><p>A function that returns the game metadata, e.g. gamecodes of season</p>
<p>Args:</p>
<pre><code>season (int): The start year of the season.
</code></pre>
<p>Returns:</p>
<pre><code>pd.DataFrame: A dataframe with the season's game metadata, e.g.
    gamecode, score, home-away teams, date, round, etc.
</code></pre></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-euroleague_api.play_by_play_data.PlayByPlay.get_game_gamecodes_season', this);">Show source &equiv;</a></p>
  <div id="source-euroleague_api.play_by_play_data.PlayByPlay.get_game_gamecodes_season" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_game_gamecodes_season</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that returns the game metadata, e.g. gamecodes of season</span>
<span class="sd">    Args:</span>
<span class="sd">        season (int): The start year of the season.</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A dataframe with the season&#39;s game metadata, e.g.</span>
<span class="sd">            gamecode, score, home-away teams, date, round, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;https://api-live.euroleague.net/v1/results&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;?seasonCode=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">competition</span><span class="si">}{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">get_requests</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">xmltodict</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">][</span><span class="s2">&quot;game&quot;</span><span class="p">])</span>
    <span class="n">int_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;gameday&quot;</span><span class="p">,</span> <span class="s2">&quot;gamenumber&quot;</span><span class="p">,</span> <span class="s2">&quot;homescore&quot;</span><span class="p">,</span> <span class="s2">&quot;awayscore&quot;</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="n">int_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">int_cols</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;played&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;played&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
        <span class="nb">bool</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s2">&quot;true&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="euroleague_api.play_by_play_data.PlayByPlay.get_game_play_by_play_data">
    <p>def <span class="ident">get_game_play_by_play_data</span>(</p><p>self, season: int, gamecode: int)</p>
    </div>
    

    
  
    <div class="desc"><p>A function that gets the play-by-play data of a particular game.</p>
<p>Args:</p>
<pre><code>season (int): The start year of the season

gamecode (int): The game-code of the game of interest.
    It can be found on Euroleague's website.
</code></pre>
<p>Returns:</p>
<pre><code>pd.DataFrame: A dataframe with the play-by-play data of the game.
</code></pre></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-euroleague_api.play_by_play_data.PlayByPlay.get_game_play_by_play_data', this);">Show source &equiv;</a></p>
  <div id="source-euroleague_api.play_by_play_data.PlayByPlay.get_game_play_by_play_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_game_play_by_play_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">gamecode</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that gets the play-by-play data of a particular game.</span>
<span class="sd">    Args:</span>
<span class="sd">        season (int): The start year of the season</span>
<span class="sd">        gamecode (int): The game-code of the game of interest.</span>
<span class="sd">            It can be found on Euroleague&#39;s website.</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A dataframe with the play-by-play data of the game.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://live.euroleague.net/api/PlaybyPlay&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;gamecode&quot;</span><span class="p">:</span> <span class="n">gamecode</span><span class="p">,</span>
        <span class="s2">&quot;seasoncode&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">competition</span><span class="si">}{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">get_requests</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Game code, </span><span class="si">{</span><span class="n">gamecode</span><span class="si">}</span><span class="s2">, did not return any data.&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>
    <span class="n">periods</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;FirstQuarter&#39;</span><span class="p">,</span> <span class="s1">&#39;SecondQuarter&#39;</span><span class="p">,</span> <span class="s1">&#39;ThirdQuarter&#39;</span><span class="p">,</span> <span class="s1">&#39;ForthQuarter&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ExtraTime&#39;</span>
    <span class="p">]</span>
    <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">period</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">periods</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">period</span><span class="p">]:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">period</span><span class="p">])</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PERIOD&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">pbp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">all_data</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pbp_df</span><span class="p">[</span><span class="s1">&#39;CODETEAM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_df</span><span class="p">[</span><span class="s1">&#39;CODETEAM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">pbp_df</span><span class="p">[</span><span class="s1">&#39;PLAYER_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_df</span><span class="p">[</span><span class="s1">&#39;PLAYER_ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">pbp_df</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_df</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">pbp_df</span><span class="p">[</span><span class="s2">&quot;MARKERTIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_df</span><span class="p">[</span><span class="s2">&quot;MARKERTIME&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">pbp_df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Season&#39;</span><span class="p">,</span> <span class="n">season</span><span class="p">)</span>
    <span class="n">pbp_df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Gamecode&#39;</span><span class="p">,</span> <span class="n">gamecode</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pbp_df</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="euroleague_api.play_by_play_data.PlayByPlay.get_game_play_by_play_data_multiple_seasons">
    <p>def <span class="ident">get_game_play_by_play_data_multiple_seasons</span>(</p><p>self, start_season: int, end_season: int)</p>
    </div>
    

    
  
    <div class="desc"><p>A function that gets the play-by-play data of <em>all</em> games in a range of
seasons</p>
<p>Args:</p>
<pre><code>start_season (int): The start year of the start season

end_season (int): The start year of the end season
</code></pre>
<p>Returns:</p>
<pre><code>pd.DataFrame: A dataframe with the play-by-play data of all games
    in range of seasons
</code></pre></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-euroleague_api.play_by_play_data.PlayByPlay.get_game_play_by_play_data_multiple_seasons', this);">Show source &equiv;</a></p>
  <div id="source-euroleague_api.play_by_play_data.PlayByPlay.get_game_play_by_play_data_multiple_seasons" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_game_play_by_play_data_multiple_seasons</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">start_season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_season</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that gets the play-by-play data of *all* games in a range of</span>
<span class="sd">    seasons</span>
<span class="sd">    Args:</span>
<span class="sd">        start_season (int): The start year of the start season</span>
<span class="sd">        end_season (int): The start year of the end season</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A dataframe with the play-by-play data of all games</span>
<span class="sd">            in range of seasons</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_range_seasons_data</span><span class="p">(</span>
        <span class="n">start_season</span><span class="p">,</span> <span class="n">end_season</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_play_by_play_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="euroleague_api.play_by_play_data.PlayByPlay.get_game_play_by_play_data_single_season">
    <p>def <span class="ident">get_game_play_by_play_data_single_season</span>(</p><p>self, season: int)</p>
    </div>
    

    
  
    <div class="desc"><p>A function that gets the play-by-play data of <em>all</em> games in a single
season</p>
<p>Args:</p>
<pre><code>season (int): The start year of the season
</code></pre>
<p>Returns:</p>
<pre><code>pd.DataFrame: A dataframe with the play-by-play data of all games
    in a single season
</code></pre></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-euroleague_api.play_by_play_data.PlayByPlay.get_game_play_by_play_data_single_season', this);">Show source &equiv;</a></p>
  <div id="source-euroleague_api.play_by_play_data.PlayByPlay.get_game_play_by_play_data_single_season" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_game_play_by_play_data_single_season</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">season</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that gets the play-by-play data of *all* games in a single</span>
<span class="sd">    season</span>
<span class="sd">    Args:</span>
<span class="sd">        season (int): The start year of the season</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A dataframe with the play-by-play data of all games</span>
<span class="sd">            in a single season</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_season_data_from_game_data</span><span class="p">(</span>
        <span class="n">season</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_play_by_play_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_df</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="euroleague_api.play_by_play_data.PlayByPlay.get_pbp_data_with_lineups">
    <p>def <span class="ident">get_pbp_data_with_lineups</span>(</p><p>self, season, gamecode, validate=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the play-by-play (PBP) data enriched with the teams' lineups for
every action in the PBP data.</p>
<p>There are three cases where the player in the corresponding row
(action) is not part of the lineup:</p>
<pre><code>1. When the player is subbed "OUT", the assigned lineup does not
contain player name. Since this is reasonable, the value of the
`validate_on_court_player` indicator is set to `True`.

2. A player passes on to a teamate, who draws a shooting foul. If
the passer is subbed before the first free throw and the first free
throw is made then the subbed player is given an assist. However,
the player is not in the extracted lineup because he has already
been subbed. The value of the `validate_on_court_player`
indicator is set to `False`. We don't fix the lineup, because it
breaks the lineup continuinity. It is a quirk of the data
collection andrecording.

3. There are a few instances where a sub is recorded many seconds
and actions since it actually happened. This causes issues, such
as a player records an actions, such as a rebound, but he comes
on the court (according to the data) many seconds after. This has
been validated by watching theactual footage of the game. This
requires a lot of manual work, which is beyond the score of this
library. It is another quirk of the datacollection and recording,
hence the value of the `validate_on_court_player` indicator is set
to `False`.
</code></pre>
<p>Args:</p>
<pre><code>season (int): The start year of the season

gamecode (int): The game-code of the game of interest.
    It can be found on Euroleague's website.

validate (bool, optional): A bool indicator whether to enrich the
    dataframe with two extra columns, which validate the validity
    and consistency of the extracted lineup. Defaults to True.
</code></pre>
<p>Returns:</p>
<pre><code>pd.DataFrame: A dataframe with the play-by-play enriched with
    teams' lineups
</code></pre></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-euroleague_api.play_by_play_data.PlayByPlay.get_pbp_data_with_lineups', this);">Show source &equiv;</a></p>
  <div id="source-euroleague_api.play_by_play_data.PlayByPlay.get_pbp_data_with_lineups" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_pbp_data_with_lineups</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">season</span><span class="p">,</span>
    <span class="n">gamecode</span><span class="p">,</span>
    <span class="n">validate</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the play-by-play (PBP) data enriched with the teams&#39; lineups for</span>
<span class="sd">    every action in the PBP data.</span>
<span class="sd">    There are three cases where the player in the corresponding row</span>
<span class="sd">    (action) is not part of the lineup:</span>
<span class="sd">        1. When the player is subbed &quot;OUT&quot;, the assigned lineup does not</span>
<span class="sd">        contain player name. Since this is reasonable, the value of the</span>
<span class="sd">        `validate_on_court_player` indicator is set to `True`.</span>
<span class="sd">        2. A player passes on to a teamate, who draws a shooting foul. If</span>
<span class="sd">        the passer is subbed before the first free throw and the first free</span>
<span class="sd">        throw is made then the subbed player is given an assist. However,</span>
<span class="sd">        the player is not in the extracted lineup because he has already</span>
<span class="sd">        been subbed. The value of the `validate_on_court_player`</span>
<span class="sd">        indicator is set to `False`. We don&#39;t fix the lineup, because it</span>
<span class="sd">        breaks the lineup continuinity. It is a quirk of the data</span>
<span class="sd">        collection andrecording.</span>
<span class="sd">        3. There are a few instances where a sub is recorded many seconds</span>
<span class="sd">        and actions since it actually happened. This causes issues, such</span>
<span class="sd">        as a player records an actions, such as a rebound, but he comes</span>
<span class="sd">        on the court (according to the data) many seconds after. This has</span>
<span class="sd">        been validated by watching theactual footage of the game. This</span>
<span class="sd">        requires a lot of manual work, which is beyond the score of this</span>
<span class="sd">        library. It is another quirk of the datacollection and recording,</span>
<span class="sd">        hence the value of the `validate_on_court_player` indicator is set</span>
<span class="sd">        to `False`.</span>
<span class="sd">    Args:</span>
<span class="sd">        season (int): The start year of the season</span>
<span class="sd">        gamecode (int): The game-code of the game of interest.</span>
<span class="sd">            It can be found on Euroleague&#39;s website.</span>
<span class="sd">        validate (bool, optional): A bool indicator whether to enrich the</span>
<span class="sd">            dataframe with two extra columns, which validate the validity</span>
<span class="sd">            and consistency of the extracted lineup. Defaults to True.</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A dataframe with the play-by-play enriched with</span>
<span class="sd">            teams&#39; lineups</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">process_sub</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">):</span>
        <span class="n">opp_sub_type</span> <span class="o">=</span> <span class="s2">&quot;OUT&quot;</span> <span class="k">if</span> <span class="n">sub_type</span> <span class="o">==</span> <span class="s2">&quot;IN&quot;</span> <span class="k">else</span> <span class="s2">&quot;IN&quot;</span>
        <span class="n">potential_indx</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pbp_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span>
                <span class="p">(</span><span class="n">pbp_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:,</span> <span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">opp_sub_type</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">potential_nops</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">potential_indx</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">processed_idxs</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">matching_idx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">potential_nops</span><span class="p">)</span>
        <span class="n">processed_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="n">processed_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matching_idx</span><span class="p">)</span>
        <span class="n">matching_row</span> <span class="o">=</span> <span class="n">pbp_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">matching_idx</span><span class="p">]</span>
        <span class="n">invalid_mask</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">matching_row</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">opp_sub_type</span><span class="p">)</span> <span class="ow">or</span>
            <span class="p">(</span><span class="n">matching_row</span><span class="p">[</span><span class="s2">&quot;CODETEAM&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">team</span><span class="p">)</span> <span class="ow">or</span>
            <span class="p">(</span><span class="n">matching_row</span><span class="p">[</span><span class="s2">&quot;MARKERTIME&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">markertime</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">invalid_mask</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Something went wrong for gamecode </span><span class="si">{</span><span class="n">gamecode</span><span class="si">}</span><span class="s2"> at sub &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;index </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> with matching sub index </span><span class="si">{</span><span class="n">matching_idx</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">player_sub</span> <span class="o">=</span> <span class="n">matching_row</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; ,&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="n">player_in</span> <span class="o">=</span> <span class="n">player</span> <span class="k">if</span> <span class="n">sub_type</span> <span class="o">==</span> <span class="s2">&quot;IN&quot;</span> <span class="k">else</span> <span class="n">player_sub</span>
        <span class="n">player_out</span> <span class="o">=</span> <span class="n">player_sub</span> <span class="k">if</span> <span class="n">sub_type</span> <span class="o">==</span> <span class="s2">&quot;IN&quot;</span> <span class="k">else</span> <span class="n">player</span>
        <span class="k">if</span> <span class="n">player_in</span> <span class="o">==</span> <span class="n">player_out</span><span class="p">:</span>
            <span class="c1"># there are instance where the same player is subbed in and out</span>
            <span class="k">return</span> <span class="n">five</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pindx</span> <span class="o">=</span> <span class="n">five</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">player_out</span><span class="p">)</span>
            <span class="n">five</span> <span class="o">=</span> <span class="n">five</span><span class="p">[:</span><span class="n">pindx</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">player_in</span><span class="p">]</span> <span class="o">+</span> <span class="n">five</span><span class="p">[</span><span class="n">pindx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>
            <span class="k">return</span> <span class="n">five</span>
    <span class="k">def</span> <span class="nf">validate_player</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">):</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;OUT&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; ,&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">col1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="n">col2</span><span class="p">]):</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">flag</span>
    <span class="c1"># Get the starting line-ups from boxscore data</span>
    <span class="n">boxscoredata</span> <span class="o">=</span> <span class="n">BoxScoreData</span><span class="p">(</span><span class="n">competition</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">competition</span><span class="p">)</span>
    <span class="n">game_bxscr_stats</span> <span class="o">=</span> <span class="n">boxscoredata</span><span class="o">.</span><span class="n">get_player_boxscore_stats_data</span><span class="p">(</span>
        <span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">,</span> <span class="n">gamecode</span><span class="o">=</span><span class="n">gamecode</span><span class="p">)</span>
    <span class="c1"># find home and away teams</span>
    <span class="n">hm_aw</span> <span class="o">=</span> <span class="n">game_bxscr_stats</span><span class="p">[[</span><span class="s2">&quot;Home&quot;</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
    <span class="n">home_team</span> <span class="o">=</span> <span class="n">hm_aw</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hm_aw</span><span class="p">[</span><span class="s2">&quot;Home&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">away_team</span> <span class="o">=</span> <span class="n">hm_aw</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hm_aw</span><span class="p">[</span><span class="s2">&quot;Home&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">starting_five</span> <span class="o">=</span> <span class="n">game_bxscr_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
        <span class="n">game_bxscr_stats</span><span class="p">[</span><span class="s2">&quot;IsStarter&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Team&quot;</span><span class="p">,</span> <span class="s2">&quot;Player&quot;</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="n">starting_five</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">starting_five</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Team&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cumcount</span><span class="p">()</span>
    <span class="c1"># Pivot the DataFrame</span>
    <span class="n">starting_five</span> <span class="o">=</span> <span class="n">starting_five</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Team&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Player&#39;</span><span class="p">)</span>
    <span class="c1"># Reset index if needed</span>
    <span class="n">starting_five</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">starting_five</span> <span class="o">=</span> <span class="n">starting_five</span><span class="p">[[</span><span class="n">home_team</span><span class="p">,</span> <span class="n">away_team</span><span class="p">]]</span>
    <span class="n">starting_five_dict</span> <span class="o">=</span> <span class="n">starting_five</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
    <span class="c1"># Fetch play-by-play data</span>
    <span class="n">pbp_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_play_by_play_data</span><span class="p">(</span>
        <span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">,</span> <span class="n">gamecode</span><span class="o">=</span><span class="n">gamecode</span><span class="p">)</span>
    <span class="c1"># Asign the starting lineups to the first entry of the PBP data.</span>
    <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;Lineup_A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;Lineup_B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">pbp_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Lineup_A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">starting_five_dict</span><span class="p">[</span><span class="n">home_team</span><span class="p">]</span>
    <span class="n">pbp_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Lineup_B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">starting_five_dict</span><span class="p">[</span><span class="n">away_team</span><span class="p">]</span>
    <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;IsHomeTeam&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;CODETEAM&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">home_team</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;CODETEAM&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">away_team</span><span class="p">,</span>
                 <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="p">)</span>
    <span class="c1"># start processing the sub entries, row by row.</span>
    <span class="n">processed_idxs</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">current_five_home</span> <span class="o">=</span> <span class="n">starting_five_dict</span><span class="p">[</span><span class="n">home_team</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">current_five_away</span> <span class="o">=</span> <span class="n">starting_five_dict</span><span class="p">[</span><span class="n">away_team</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">pbp_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">playtype</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PLAYTYPE&quot;</span><span class="p">]</span>
        <span class="c1"># there are rare instances of an extra space in player name</span>
        <span class="n">player</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PLAYER&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; ,&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">team</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;CODETEAM&quot;</span><span class="p">]</span>
        <span class="n">markertime</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;MARKERTIME&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">team</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">is_home</span> <span class="o">=</span> <span class="n">home_team</span> <span class="o">==</span> <span class="n">team</span>
            <span class="n">five</span> <span class="o">=</span> <span class="n">current_five_home</span> <span class="k">if</span> <span class="n">is_home</span> <span class="k">else</span> <span class="n">current_five_away</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">playtype</span> <span class="o">==</span> <span class="s2">&quot;OUT&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">processed_idxs</span><span class="p">):</span>
                <span class="n">five</span> <span class="o">=</span> <span class="n">process_sub</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">playtype</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">playtype</span> <span class="o">==</span> <span class="s2">&quot;IN&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">processed_idxs</span><span class="p">):</span>
                <span class="n">five</span> <span class="o">=</span> <span class="n">process_sub</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">playtype</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_home</span><span class="p">:</span>
                <span class="n">current_five_home</span> <span class="o">=</span> <span class="n">five</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">current_five_away</span> <span class="o">=</span> <span class="n">five</span>
        <span class="n">pbp_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;Lineup_A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_five_home</span>
        <span class="n">pbp_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;Lineup_B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_five_away</span>
    <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
        <span class="n">lu_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">pbp_data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">u</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Lineup_&quot;</span><span class="p">)]</span>
        <span class="n">pbp_data</span><span class="p">[</span><span class="s2">&quot;validate_on_court_player&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pbp_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">validate_player</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lu_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lu_cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">pbp_data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="euroleague_api.play_by_play_data.PlayByPlay.get_pbp_data_with_lineups_multiple_seasons">
    <p>def <span class="ident">get_pbp_data_with_lineups_multiple_seasons</span>(</p><p>self, start_season: int, end_season: int)</p>
    </div>
    

    
  
    <div class="desc"><p>A function that gets the play-by-play data enriched with team lineups
of <em>all</em> games in a range of seasons</p>
<p>Args:</p>
<pre><code>start_season (int): The start year of the start season

end_season (int): The start year of the end season
</code></pre>
<p>Returns:</p>
<pre><code>pd.DataFrame: A dataframe with the play-by-play data of all games
    in range of seasons
</code></pre></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-euroleague_api.play_by_play_data.PlayByPlay.get_pbp_data_with_lineups_multiple_seasons', this);">Show source &equiv;</a></p>
  <div id="source-euroleague_api.play_by_play_data.PlayByPlay.get_pbp_data_with_lineups_multiple_seasons" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_pbp_data_with_lineups_multiple_seasons</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">start_season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_season</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that gets the play-by-play data enriched with team lineups</span>
<span class="sd">    of *all* games in a range of seasons</span>
<span class="sd">    Args:</span>
<span class="sd">        start_season (int): The start year of the start season</span>
<span class="sd">        end_season (int): The start year of the end season</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A dataframe with the play-by-play data of all games</span>
<span class="sd">            in range of seasons</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_range_seasons_data</span><span class="p">(</span>
        <span class="n">start_season</span><span class="p">,</span> <span class="n">end_season</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pbp_data_with_lineups</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="euroleague_api.play_by_play_data.PlayByPlay.get_pbp_data_with_lineups_single_season">
    <p>def <span class="ident">get_pbp_data_with_lineups_single_season</span>(</p><p>self, season: int)</p>
    </div>
    

    
  
    <div class="desc"><p>A function that gets the play-by-play data enriched with team lineups
of <em>all</em> games in a single season</p>
<p>Args:</p>
<pre><code>season (int): The start year of the season
</code></pre>
<p>Returns:</p>
<pre><code>pd.DataFrame: A dataframe with the play-by-play data of all games
    in a single season
</code></pre></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-euroleague_api.play_by_play_data.PlayByPlay.get_pbp_data_with_lineups_single_season', this);">Show source &equiv;</a></p>
  <div id="source-euroleague_api.play_by_play_data.PlayByPlay.get_pbp_data_with_lineups_single_season" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_pbp_data_with_lineups_single_season</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">season</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that gets the play-by-play data enriched with team lineups</span>
<span class="sd">    of *all* games in a single season</span>
<span class="sd">    Args:</span>
<span class="sd">        season (int): The start year of the season</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A dataframe with the play-by-play data of all games</span>
<span class="sd">            in a single season</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_season_data_from_game_data</span><span class="p">(</span>
        <span class="n">season</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pbp_data_with_lineups</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_df</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="euroleague_api.play_by_play_data.PlayByPlay.get_range_seasons_data">
    <p>def <span class="ident">get_range_seasons_data</span>(</p><p>self, start_season: int, end_season: int, fun: Callable[[int, int], pandas.core.frame.DataFrame])</p>
    </div>
    

    
  
    <div class="desc"><p>A wrapper function with the all game data in a range of seasons</p>
<p>Args:</p>
<pre><code>season (int, optional): The start year of the season.

end_season (int): The start year of teh end season

fun (Callable[[int, int], pd.DataFrame]): A callable function that
    determines that type of data to be collected. Available values:
    - get_game_report
    - get_game_stats
    - get_game_teams_comparison
</code></pre>
<p>Returns:</p>
<pre><code>pd.DataFrame: A dataframe with the game data
</code></pre></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-euroleague_api.play_by_play_data.PlayByPlay.get_range_seasons_data', this);">Show source &equiv;</a></p>
  <div id="source-euroleague_api.play_by_play_data.PlayByPlay.get_range_seasons_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_range_seasons_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">start_season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">end_season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A wrapper function with the all game data in a range of seasons</span>
<span class="sd">    Args:</span>
<span class="sd">        season (int, optional): The start year of the season.</span>
<span class="sd">        end_season (int): The start year of teh end season</span>
<span class="sd">        fun (Callable[[int, int], pd.DataFrame]): A callable function that</span>
<span class="sd">            determines that type of data to be collected. Available values:</span>
<span class="sd">            - get_game_report</span>
<span class="sd">            - get_game_stats</span>
<span class="sd">            - get_game_teams_comparison</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A dataframe with the game data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span>
            <span class="n">start_season</span><span class="p">,</span> <span class="n">end_season</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Season loop&quot;</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">data_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_season_data_from_game_data</span><span class="p">(</span><span class="n">season</span><span class="p">,</span> <span class="n">fun</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="euroleague_api.play_by_play_data.PlayByPlay.get_season_data_from_game_data">
    <p>def <span class="ident">get_season_data_from_game_data</span>(</p><p>self, season: int, fun: Callable[[int, int], pandas.core.frame.DataFrame])</p>
    </div>
    

    
  
    <div class="desc"><p>A wrapper function for getting game data for all games in a single
season.</p>
<p>Args:</p>
<pre><code>season (int, optional): The start year of the season.

fun (Callable[[int, int], pd.DataFrame]): A callable function that
    determines that type of data to be collected. Available values:
    - get_game_report
    - get_game_stats
    - get_game_teams_comparison
</code></pre>
<p>Returns:</p>
<pre><code>pd.DataFrame: A dataframe with the game data.
</code></pre></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-euroleague_api.play_by_play_data.PlayByPlay.get_season_data_from_game_data', this);">Show source &equiv;</a></p>
  <div id="source-euroleague_api.play_by_play_data.PlayByPlay.get_season_data_from_game_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_season_data_from_game_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A wrapper function for getting game data for all games in a single</span>
<span class="sd">    season.</span>
<span class="sd">    Args:</span>
<span class="sd">        season (int, optional): The start year of the season.</span>
<span class="sd">        fun (Callable[[int, int], pd.DataFrame]): A callable function that</span>
<span class="sd">            determines that type of data to be collected. Available values:</span>
<span class="sd">            - get_game_report</span>
<span class="sd">            - get_game_stats</span>
<span class="sd">            - get_game_teams_comparison</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A dataframe with the game data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">game_metadata_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_gamecodes_season</span><span class="p">(</span><span class="n">season</span><span class="p">)</span>
    <span class="n">game_metadata_df</span> <span class="o">=</span> <span class="n">game_metadata_df</span><span class="p">[</span><span class="n">game_metadata_df</span><span class="p">[</span><span class="s2">&quot;played&quot;</span><span class="p">]]</span>
    <span class="n">game_codes_df</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">game_metadata_df</span><span class="p">[[</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="s2">&quot;gameday&quot;</span><span class="p">,</span> <span class="s2">&quot;gamenumber&quot;</span><span class="p">]]</span>
        <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;gamenumber&quot;</span><span class="p">,</span> <span class="s2">&quot;gameday&quot;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">game_codes_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">(),</span>
                       <span class="n">total</span><span class="o">=</span><span class="n">game_codes_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                       <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">game_code</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;gamenumber&quot;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">season</span><span class="p">,</span> <span class="n">game_code</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Game </span><span class="si">{</span><span class="n">game_code</span><span class="si">}</span><span class="s2"> returned no data.&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;Phase&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;round&quot;</span> <span class="ow">in</span> <span class="n">row</span><span class="p">):</span>
                <span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Phase&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;round&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;Round&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;gameday&quot;</span> <span class="ow">in</span> <span class="n">row</span><span class="p">):</span>
                <span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Round&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;gameday&quot;</span><span class="p">])</span>
            <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;HTTPError: Didn&#39;t find gamecode </span><span class="si">{</span><span class="n">game_code</span><span class="si">}</span><span class="s2"> for season &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">. Invalid </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">. Skip and continue.&quot;</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># noqa: E722</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Something went wrong for game </span><span class="si">{</span><span class="n">game_code</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error message: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Skip and continue&quot;</span>
            <span class="p">)</span>
    <span class="k">if</span> <span class="n">data_list</span><span class="p">:</span>
        <span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">data_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([])</span>
    <span class="k">return</span> <span class="n">data_df</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="euroleague_api.play_by_play_data.PlayByPlay.make_season_game_url">
    <p>def <span class="ident">make_season_game_url</span>(</p><p>self, season: int, game_code: int, endpoint: str)</p>
    </div>
    

    
  
    <div class="desc"><p>Concatenates the base URL and makes the game url.</p>
<p>Args:</p>
<pre><code>season (int): The start year of the season

game_code (int): The code of the game. Find the code from
    Euroleague's website

endpoint (str): The endpoint of the API
</code></pre>
<p>Returns:</p>
<pre><code>str: the full URL
</code></pre></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-euroleague_api.play_by_play_data.PlayByPlay.make_season_game_url', this);">Show source &equiv;</a></p>
  <div id="source-euroleague_api.play_by_play_data.PlayByPlay.make_season_game_url" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">make_season_game_url</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">game_code</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Concatenates the base URL and makes the game url.</span>
<span class="sd">    Args:</span>
<span class="sd">        season (int): The start year of the season</span>
<span class="sd">        game_code (int): The code of the game. Find the code from</span>
<span class="sd">            Euroleague&#39;s website</span>
<span class="sd">        endpoint (str): The endpoint of the API</span>
<span class="sd">    Returns:</span>
<span class="sd">        str: the full URL</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">full_url</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s2">/seasons/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">competition</span><span class="si">}{</span><span class="n">season</span><span class="si">}</span><span class="s2">/&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;games/</span><span class="si">{</span><span class="n">game_code</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">endpoint</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">full_url</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>
</article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Generated by <a href="https://github.com/timothycrosley/pdocs">pdocs 1.2.0</a>
    </p>
  </footer>
</div>
</body>
</html>
